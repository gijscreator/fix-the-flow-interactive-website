<div id="cameraWrapper">
    <video id="video" autoplay playsinline></video>
    <button id="captureBtn">Maak foto</button>
    <canvas id="canvas" style="display:none;"></canvas>
    <img id="preview" />
</div>

<script>
const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const captureBtn = document.getElementById('captureBtn');
const preview = document.getElementById('preview');

// Camera starten
async function startCamera() {
    try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
        video.srcObject = stream;
    } catch (err) {
        console.error("Camera kan niet gestart worden:", err);
    }
}

// Foto maken en vierkant bijsnijden
captureBtn.addEventListener('click', () => {
    const size = Math.min(video.videoWidth, video.videoHeight);
    canvas.width = size;
    canvas.height = size;

    const ctx = canvas.getContext('2d');
    ctx.drawImage(
        video,
        (video.videoWidth - size) / 2, // x offset
        (video.videoHeight - size) / 2, // y offset
        size, size,
        0, 0,
        size, size
    );

    // Preview in img tag tonen
    preview.src = canvas.toDataURL('image/png');

    // Hier kun je canvas.toBlob gebruiken om te uploaden naar je database
    canvas.toBlob(blob => {
        // uploadBlob(blob)
        console.log("Foto klaar om te uploaden:", blob);
    }, 'image/png');
});

startCamera();
</script>
